{% extends "../base.html" %}
<!-- 2015-09-19 YangHaitao -->
{% block title %}
{{_("CV - ")}}{{file_name}}
{% end %}

{% block stylesheet %}
<!-- <link href="{{ static_url('css/input.css') }}" rel="stylesheet" > -->
<link href="{{ static_url('js/codemirror/lib/codemirror.css') }}" rel="stylesheet" >
<link href="{{ static_url('js/codemirror/theme/elegant.css') }}" rel="stylesheet" >
<style type="text/css">
.hljs-line-numbers {
    text-align: right;
    border-right: 1px solid #ccc;
    color: #999;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
.hljs-highlight-line {
    text-align: right;
    border-right: 0px solid #000;
    background-color: #ccc;
    color: #00f;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
</style>
{% end %}

{% block header %}
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="navbar-header"> 
        <a id="navbar_header" class="navbar-brand" href="/">{{_("CallingViewer")}}</a>
    </div>
    <div id="file_path_div" class="collapse navbar-collapse">
    </div>
</div>
{% end %}

{% block body %}
<div class="col-lg-12" style="margin-top: 55px; padding: 0px;">
    <div id="code_div" class="col-lg-12" style="padding: 0px; overflow: auto;">
        <textarea id="code" rows="4" class="code"></textarea>
    </div>
</div>
{% end %}

{% block javascript %}
<script src="{{ static_url('js/codemirror/lib/codemirror.js') }}"></script>
<script type="text/javascript">
var result = "{% module JsString(result) %}";
var line = 0;
var data = JSON.parse(result);
if (data.path) {
    $("#file_path_div").append(
        '<p class="navbar-text" style="text-align: center; padding: 12px;">' + data.path + '</p>'
    );
}

code_type = "";
if (data.code) {
    if (data.ext && data.ext != '') {
        switch (data.ext) {
            case ".go":
                code_type = "text/x-go";
                break;
            case ".py":
                code_type = "python";
                break;
            case ".sh":
                code_type = "bash";
                break;
            case ".c":
                code_type = "c";
                break;
            case ".cc":
                code_type = "c++";
                break;
            case ".html":
                code_type = "html";
                break;
            case ".css":
                code_type = "css";
                break;
            case ".js":
                code_type = "javascript";
                break;
            case ".xml":
                code_type = "xml";
                break;
            case ".json":
                code_type = "json";
                break;
            case ".sql":
                code_type = "sql";
                break;
            case ".php":
                code_type = "php";
                break;
            default:
                code_type = "";
        }
    }
}

if (data.line) {
    line = data.line;
}

console.log(code_type);
$(document).ready(function(){
    var codeMirror = CodeMirror.fromTextArea(document.getElementById('code'), {
        lineNumbers: true,
        lineWrapping: false,
        mode: "text/x-go",
        theme: 'elegant',
    });
    codeMirror.getDoc().setValue(data.code);
    // codeMirror.setSize(1000, 500);
});
</script>
{% end %}